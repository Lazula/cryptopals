I feel REALLY stupid right now. I wrote the program perfectly, but I made one mistake that was really dumb and really hard to find: When calculating the length of the base64-encoded string ((((4 * input_length)/3) | 3) + 1), I used a bitwise AND (&) instead of bitwise OR (|). I found it when in gdb I saw that base64_encoded_text_length was 1. This caused all of my heap operations to overflow and overwrite metadata, causing strings to flow over into each other and errors on free.
